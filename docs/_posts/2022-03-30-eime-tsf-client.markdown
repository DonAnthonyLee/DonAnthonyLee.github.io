---
layout: post
title:  "EIME-TSF 客户端"
date:   2022-03-30 18:00:00 +0800
categories: EIME
---

提供 [EIME-TSF 客户端](https://github.com/DonAnthonyLee/DonAnthonyLee.github.io/raw/main/stuff/eime-tsf-client-0.1.10.zip "EIME-TSF 客户端下载")，适用于 Windows XP SP2 ~ Windows 11 系统，兼容 x86 架构及 x64 架构。


# 版本与功能

此客户端仅起翻译作用，既是将 TSF 接口翻译为 EIME 服务端所需，又是将 EIME 服务端的处理结果再翻译为 TSF 接口所需。

注：此客户端目前不适用于 Windows 10/11 S 模式。


现版本：0.1.10

更新日期：2022-09-07


最近变更历史：

0.1.10, 修正多窗口输入切换时偶尔出现无法输入的问题（需配合 EIME 服务端 0.1.12）；修正勾选 “使用系统切换键” 选项时问题

0.1.9, 增加任务栏深色模式检测; 修正使用辅助窗口时光标定位问题；增加“使用系统切换键”选项

0.1.8, 改进客户端与服务端之间通信稳定性

0.1.7, 忽略系统自身输入法/非输入法切换键（高级键盘选项设置）

0.1.6e, 修正安装时注册失败及部分系统兼容性问题

0.1.6, 按微软相关文档改进注册方式（部分系统注册失败）

0.1.3, 首次公开提供


# 安装

将文件解压到系统文件夹（比如 C:\Program Files 或 C:\Windows 等）下的任意子文件夹（建议采用 C:\Program Files\eime），右键选择 install.cmd 文件后以管理员身份运行。

注：install.cmd 脚本为自动注册 eime-tsf.dll 及 eime-tsf-x86.dll 两个文件。


# 卸载

右键选择 uninstall.cmd 文件后以管理员身份运行。


# 升级

建议采用先卸载并重新登录后再进行安装的方法；版本号仅仅最后一位产生变更时，可采用文件替换进行升级。


# 已知问题

+ 用户登录后等待 EIME 服务端自动启动后才能使用。

目前 EIME 服务端（商店应用）若用户未曾在应用设置或系统控制设置中禁止时，将在用户登录后自动启动；此时，客户端将自动连接并进入可使用状态。

因系统自动延时启动，桌面出现约十几秒钟后 EIME 服务端方才启动完成；急于使用时可自行手动先开启服务端~~，只是过后会因自动启动转换成调试器而已，手动关闭即可~~。

如果用户在应用设置或系统控制设置中禁止 EIME 服务端自动启动，需要使用输入法前同样需要手动开启服务端。


+ 终止或卸载 EIME 服务端时，EIME 服务端产生崩溃或无响应（挂起）

~~因系统在终止或卸载 EIME 服务端时，自动销毁 ETK++ 图形引擎的主要组件，因而产生所述现象，目前未有较好处理方法；该现象不影响 EIME 服务端使用。~~


+ 更新客户端文件时，因系统正在调用而无法替换文件

请注销当前用户并重新登录，且确保登录后未切换至 EIME 输入法，再进行文件替换。


# 后话

+ 对其他应用程序的影响及免责申明

目前的处理方式，已尽可能地避免因输入法而影响您正在输入时所使用程序的稳定性，但我不能保证一定不会使您正在输入时所使用程序（后面皆称为 主程序）产生崩溃、无响应等问题。您应该注意时常保存正在编辑的内容，以避免因程序的不稳定性而产生数据丢失；而且，因此产生的任何问题及损失，都不属于 EIME（或称 ETK++ 输入扩展组件）的承担范围。

注：潮州白话字输入法将输出有别于常见文字编码的部分 Unicode 编码，包括可变调符、复合文字块等，这些编码在一些程序中并不能被程序很好地处理；在早期 Windows 系统的 写字板 程序，这些字符会触发程序产生崩溃。

+ 为何使用服务端、客户端的处理方式

Windows 系统的 Text Services Framework（简称TSF）接口采用 COM 组件方式接入主程序；对于传统桌面程序而言，输入法组件与主程序运行在同一进程，输入法组件所引用的各类运行时库将对主程序产生不利影响，同时，输入法组件不稳定可直接影响主程序的稳定性；对于 UWP  类程序（通常为商店应用），输入法组件不稳定甚至可能直接影响到整个系统的稳定性。

正是由于以上原因，EIME 目前采用服务端与客户端分离的处理方式；TSF 客户端只负责系统接口与服务端的通信与输出，并极大可能地减少所引用的运行时库（目前均为 Windows 系统自带运行时库），且客户端不存在任何用户界面（UI）相关处理；所有输入法实际处理、用户界面处理等工作由 EIME 服务端负责，这为以后各种扩充组件的实现提供了良好的平台，也保证了最大的兼容性。~~当然，此处理方式也存在一定缺陷，比如会偶尔产生待选字词窗口被主程序窗口遮盖等，因服务端与主程序处于不同的进程（甚至不同的 APP 容器），目前此缺陷短期内难以克服。~~



